<!-- hier nur html-elemente und js-code -->
<!-- teaser-Name "neuerscheinungen" (DE) oder "neuerscheinungen_en" (EN) -->

<div id="erwerbungsListe_Wirtschaft">
  <div class="link 1"></div> 
</div>

<script>

function Neuerwerbung_Wirtschaft(mon, lang) {
  
  
  let SuchstringQuery = "query=any,contains,UZB~2FZ01~2FXXXXXX~2Fsaum,AND&query=lds56,contains,650,OR&query=any,contains,UZB~2FZ01~2FXXXXXX~2Fstet,AND&query=lds56,contains,330,OR&query=any,contains,UBFB-XXXXXX,OR&query=any,contains,UECON-XXXXXX,";
    
  // Datum heute
  const d = new Date(Date.now());
  const Datum = d.toISOString();
  // ISO-String z.B. "2022-02-18T13:38:17.783Z"
  let Jahr = Datum.slice(0,4);
  //console.log(Jahr);
  const Monat = Datum.slice(5,7);
  
  // Letztes Jahr
  const ynum = Number(Jahr); 
  const lynum = ynum - 1;
  const LetztesJahr = String(lynum);
  
  //  Letzter Monat
  const mnum = Number(Monat);
  
  
  let monate, linkPrefix, linkSuffix, LinkTextPrefix, LinkTextSuffix;

  if (lang === "en"){
      monate = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
      linkPrefix = "https://uzb.swisscovery.slsp.ch/discovery/search?";
      linkSuffix =",AND&tab=LibraryCatalog&search_scope=MyInstitution&vid=41SLSP_UZB:UZB&lang=en&mode=advanced&offset=0";
      LinkTextPrefix = "New print publications ";
      LinkTextSuffix = ""; 
      
  } else {
      monate = ["Januar", "Februar", "MÃ¤rz", "April", "Mai", "Juni", "Juli", "August", "September", "Oktober", "November", "Dezember"];
      linkPrefix = "https://uzb.swisscovery.slsp.ch/discovery/search?";
      linkSuffix = ",AND&tab=LibraryCatalog&search_scope=MyInstitution&vid=41SLSP_UZB:UZB&mode=advanced&offset=0";
      LinkTextPrefix = "Neuerwerbungen ";
      LinkTextSuffix = " (nur print)"; 
  }
  
  
  let xm = mnum - mon;
  
  if (xm < 1){
      xm = 12 + xm;
      Jahr = LetztesJahr;
  }
  let ym = xm - 1; 
  let monatString = monate[ym] + " " + String(Jahr);

  let linkText = LinkTextPrefix + monatString + LinkTextSuffix;
 

  let xm_string;
  xm_string = ("0" + xm).slice(-2);
  yearMonat = Jahr + xm_string;
  SuchstringQuery = SuchstringQuery.replaceAll("XXXXXX", yearMonat)
  let SuchstringMonat = linkPrefix + SuchstringQuery + linkSuffix;

  
  return [SuchstringMonat, linkText];
}

// Linkliste erstellen und DOM in HTML hineinschieben
document.addEventListener("DOMContentLoaded", function() {
  let anchor = document.querySelector("#erwerbungsListe_Wirtschaft");
  let ancElement = document.querySelector("#erwerbungsListe_Wirtschaft .link");
  let lang = document.documentElement.lang;
 
  let mon = Number(ancElement.classList[1]);
  let return_obj = Neuerwerbung_Wirtschaft(mon, lang);
  let monatlink = return_obj[0];
  let linktext = return_obj[1];
  
  let contents = '<a href=' + monatlink + ' target="_blank" rel="noopener noreferrer">' + linktext + '</a>'
   

  anchor.innerHTML = contents;
});

</script>